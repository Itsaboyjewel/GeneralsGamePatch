; Patch104p Jundiyy 20/10/2021 Implement Repair Drone for Tech War Factory and custom maps.

;------------------------------------------------------------------------------
Object VehicleRepairDrone

  ; *** ART Parameters ***

  SelectPortrait         = SSRepairDrone ;SARAmblnce_L ;Could use this as well.
  ButtonImage            = SSRepairDrone ;SARAmblnce

  Draw = W3DTankDraw ModuleTag_01
    ConditionState = NONE
      Model = AVRepairDr
    End
    TrackMarks = EXTireTrack.tga

    OkToChangeModelColor = Yes
  End

  ; ***DESIGN parameters ***
  DisplayName      = OBJECT:RepairDrone
  Side = America
  EditorSorting   = VEHICLE

  TransportSlotCount = 1                 ;how many "slots" we take in a transport (0 == not transportable)

  ArmorSet
    Conditions      = None
    Armor           = SentryDroneArmor
    DamageFX        = TruckDamageFX
  End
  BuildCost       = 500
  BuildTime       = 6.0          ;in seconds
  VisionRange     = 150
  ShroudClearingRange = 150
  ExperienceValue    = 50 100 150 400 ;Experience point value at each level
  ExperienceRequired = 0 150 450 900 ;Experience points needed to gain each level
  IsTrainable     = No
  CrusherLevel           = 0  ;What can I crush?: 1 = infantry, 2 = trees, 3 = vehicles
  CrushableLevel         = 2  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
  CommandSet    = GenericCommandSet ;Allows mixed units to still use Attack Move and Guard Mode.

  ; *** AUDIO Parameters *** ;Using Sentry Drone sounds for now.
  VoiceSelect           = SentryDroneVoiceSelect
  VoiceMove             = SentryDroneVoiceMove
  VoiceGuard            = SentryDroneVoiceMove
  VoiceAttack           = SentryDroneVoiceMove
  SoundMoveStart        = SentryDroneMoveStart
  SoundMoveStartDamaged = SentryDroneMoveStart
  UnitSpecificSounds
    ; These have the syntax of SomeNameSomewhereInCode = SomeNameSomewhereInLookupINIs
    VoiceCreate         = SentryDroneVoiceSelect
    TurretMoveStart     = NoSound
    TurretMoveLoop      = NoSound
    VoiceEnter          = NoSound
    Deploy              = NoSound
    Undeploy            = NoSound
  End


  ; *** ENGINEERING Parameters ***
  RadarPriority = UNIT
  KindOf = PRELOAD SELECTABLE CAN_ATTACK CAN_CAST_REFLECTIONS VEHICLE SCORE DRONE

  Body = ActiveBody ModuleTag_02
    MaxHealth       = 300.0
    InitialHealth   = 300.0
    SubdualDamageCap = 600
    SubdualDamageHealRate = 500
    SubdualDamageHealAmount = 50
  End

  Behavior = AIUpdateInterface ModuleTag_03
  End
  Locomotor = SET_NORMAL BasicTankLocomotor

  Behavior = PhysicsBehavior ModuleTag_04
    Mass = 50.0
  End

  Behavior = SlowDeathBehavior ModuleTag_05
    DeathTypes = ALL -CRUSHED -SPLATTED
    DestructionDelay  = 500
    DestructionDelayVariance  = 100
    FX  = INITIAL  FX_GenericTankDeathEffect
    OCL = MIDPOINT OCL_AmericaVehicleSentryDroneDie
    FX =  FINAL FX_AmericaVehicleTomahawkDeathExplosion
  End

  Behavior = DestroyDie ModuleTag_07
    DeathTypes = NONE +CRUSHED +SPLATTED
  End

  Behavior = FXListDie ModuleTag_08
    DeathTypes = NONE +CRUSHED +SPLATTED
    DeathFX = FX_CarCrush
  End

  Behavior = CreateCrateDie ModuleTag_09
    CrateData = SalvageCrateData
   ;CrateData = EliteTankCrateData
   ;CrateData = HeroicTankCrateData
  End

  Behavior = TransitionDamageFX ModuleTag_10
    ReallyDamagedParticleSystem1 = Bone:Smoke RandomBone:Yes PSys:SmokeSmallContinuous01
    ReallyDamagedFXList1 = Loc: X:0 Y:0 Z:0 FXList:FX_BattleMasterDamageTransition
  End

  Behavior = FlammableUpdate ModuleTag_21
    AflameDuration = 5000         ; If I catch fire, I'll burn for this long...
    AflameDamageAmount = 3       ; taking this much damage...
    AflameDamageDelay = 500       ; this often.
  End

  Behavior = AutoHealBehavior ModuleTag_Heal23
    HealingAmount     = 5
    HealingDelay      = 1000 ; msec
    Radius            = 100.0f
    StartsActive      = Yes
    KindOf            = VEHICLE
    ForbiddenKindOf   = AIRCRAFT
    SkipSelfForHealing = Yes
  End

  Geometry = BOX
  GeometryMajorRadius = 11.0
  GeometryMinorRadius = 7.0
  GeometryHeight = 10.0
  GeometryIsSmall = Yes
  Shadow = SHADOW_VOLUME

End
